# PyAST-RAG
é’ˆå¯¹ Python ä»£ç åº“ä¼˜åŒ–çš„ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰å·¥å…·ï¼Œåˆ©ç”¨ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰å®ç°ç»“æ„åŒ–ä»£ç åˆ‡åˆ†å’Œä¾èµ–è¿½è¸ªã€‚

ğŸš€ ç›®å‰å·²æˆåŠŸè§£æ **<!-- REPO_COUNT -->26** ä¸ªçƒ­é—¨é¡¹ç›®ï¼Œç´¯è®¡å¤„ç† **<!-- LOC_COUNT -->220,008** è¡Œæ ¸å¿ƒä»£ç ã€‚

![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)
![RAG](https://img.shields.io/badge/AI-RAG-green.svg)
![AST](https://img.shields.io/badge/Core-AST-orange.svg)

**PyAST-RAG** æ˜¯ä¸€ä¸ªæœ¬åœ°åŒ–çš„ä»£ç æ£€ç´¢å¢å¼ºç”Ÿæˆ (RAG) ç³»ç»Ÿã€‚ä¸ä¼ ç»Ÿçš„åŸºäºæ–‡æœ¬é•¿åº¦çš„åˆ‡åˆ†ä¸åŒï¼Œæœ¬é¡¹ç›®åˆ©ç”¨ **AST (æŠ½è±¡è¯­æ³•æ ‘)** æŠ€æœ¯ï¼Œå®ç°äº†**ç±»ä¸å‡½æ•°ç²’åº¦çš„ 100% å®Œæ•´æ€§åˆ‡åˆ†**ï¼Œå¹¶ä¿ç•™äº†ä»£ç çš„å±‚çº§ç»“æ„å’Œä¾èµ–å…³ç³»ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹©PyAST-RAG
ä¼ ç»Ÿçš„ RAG å·¥å…·é€šå¸¸æŒ‰å­—ç¬¦æ•°æˆ–å›ºå®šçª—å£å¤§å°åˆ‡åˆ†ä»£ç ï¼Œè¿™ç ´åäº†ä»£ç çš„è¯­ä¹‰ç»“æ„ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªå‡½æ•°å¯èƒ½è¢«åˆ‡æˆä¸¤åŠï¼‰ã€‚
**Python-AST-RAG** é€šè¿‡è§£æ Python çš„ ASTï¼Œç¡®ä¿æ¯ä¸ªä»£ç å—éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„å‡½æ•°æˆ–ç±»ï¼Œå¹¶è‡ªåŠ¨è¿½è¸ªå…¶æ‰€å±çš„ç±»å’Œå†…éƒ¨ä¾èµ–é¡¹ï¼Œä»è€Œæä¾›æ›´ç²¾å‡†çš„ä»£ç ä¸Šä¸‹æ–‡æ£€ç´¢ã€‚

## æ ¸å¿ƒç‰¹æ€§

1. **AST è¯­ä¹‰åˆ‡åˆ†**: æ‹’ç»æˆªæ–­é€»è¾‘ï¼Œæ¯ä¸€ä¸ª Chunk éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯­æ³•å•å…ƒã€‚
2. **ç²¾å‡†ä¸Šä¸‹æ–‡æ£€ç´¢**: åŸºäº ChromaDB çš„å…ƒæ•°æ®å¢å¼ºæ£€ç´¢ï¼Œç²¾å‡†å®šä½å‡½æ•°å®šä¹‰ã€‚
3. **å®Œå…¨æœ¬åœ°åŒ–é—­ç¯**: ä»è§£æåˆ°å‘é‡å­˜å‚¨å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œä¿æŠ¤ä»£ç éšç§ï¼ˆä»…ç”Ÿæˆé˜¶æ®µè°ƒç”¨ LLM APIï¼‰ã€‚

## è¡Œä¸šçº§æ¨ªå‘æµ‹è¯„ (Industry Benchmark)
æˆ‘ä»¬é’ˆå¯¹ `requests` åº“ï¼ˆ1.1 ä¸‡è¡Œä»£ç ï¼‰è¿›è¡Œäº†å…¨åœºæ™¯æ¨ªå‘æµ‹è¯„ï¼Œå¯¹æ¯”äº† PyAST-RAG ä¸ä¸šå†…ä¸»æµæ–¹æ¡ˆçš„è¡¨ç°ï¼š

| åˆ‡åˆ†æ–¹æ¡ˆ | è¯­æ³•åˆæ³•ç‡ | å‡½æ•°å®Œæ•´åº¦ | è£…é¥°å™¨ä¸¢å¤±ç‡ | ä½œç”¨åŸŸå‡†ç¡®ç‡ | è§£æè€—æ—¶ (ms/ä¸‡è¡Œ) |
| :--- | :---: | :---: | :---: | :---: | :---: |
| Simple Splitter | 32.3% | 33.8% | 10.9% | 0.0% | **6.70** |
| LangChain Regex | 42.5% | 48.4% | 33.6% | 0.0% | **6.42** |
| LlamaIndex (TS) | 37.4% | 45.2% | 24.8% | 0.0% | 150.94 |
| **PyAST-RAG (æœ¬é¡¹ç›®)** | **100.0%** | **100.0%** | **0.0%** | **79.4%** | 1182.68 |

### æµ‹è¯„ç»“è®ºï¼š
1.  **è¯­ä¹‰é›¶æŸè€—**: **PyAST-RAG** æ˜¯å”¯ä¸€å®ç° **100% è¯­æ³•åˆæ³•æ€§** å’Œ **é›¶è£…é¥°å™¨ä¸¢å¤±** çš„æ–¹æ¡ˆã€‚è¿™æ„å‘³ç€ AI æ£€ç´¢åˆ°çš„ä»£ç ç‰‡æ®µæ°¸è¿œæ˜¯åŠŸèƒ½å®Œå¤‡ã€é€»è¾‘è¿ç»­çš„ã€‚
2.  **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: æˆ‘ä»¬çš„æ–¹æ¡ˆæä¾›äº†é«˜è¾¾ **79.4%** çš„ä½œç”¨åŸŸè¯†åˆ«ç‡ï¼ˆClass å½’å±ï¼‰ï¼Œå½»åº•è§£å†³äº† RAG ä¸­çš„â€œå­¤å„¿ä»£ç å—â€é—®é¢˜ã€‚
3.  **å·¥ä¸šçº§æ·±åº¦**: å³ä¾¿é¢å¯¹ LlamaIndex è¿™ç§åŸºäº Tree-sitter çš„é‡å‹å·¥ä¸šçº§æ–¹æ¡ˆï¼ŒPyAST-RAG åœ¨ Python é¢†åŸŸçš„ç²¾ç¡®åº¦ä¾ç„¶ä¿æŒç»å¯¹é¢†å…ˆã€‚

> **æ³¨**ï¼šæ•°æ®ç”± `benchmarks/scripts/full_stack_stats.py` è‡ªåŠ¨ç”Ÿæˆã€‚æµ‹è¯•ç¯å¢ƒï¼špsf/requests å…¨é‡ä»£ç ã€‚

## æŠ€æœ¯ä¼˜åŠ¿æ€»ç»“ (Technical Deep-Dive)
ä¸ºä»€ä¹ˆ **PyAST-RAG** æ˜¯æ„å»º Python ä»£ç åŠ©æ‰‹ï¼ˆCode Agentï¼‰çš„æ›´å¥½é€‰æ‹©ï¼Ÿ

1.  **è£…é¥°å™¨ç²˜æ€§ (Decorator Persistence)**:
    åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼ŒLangChain æ–¹æ¡ˆä¼šæœ‰ **31.67%** çš„æ¦‚ç‡å°† `@property` æˆ– `@retry` ç­‰è£…é¥°å™¨ä¸å‡½æ•°ä½“åˆ‡æ•£ã€‚**PyAST-RAG ä¿è¯ 0% ä¸¢å¤±ç‡**ï¼Œç¡®ä¿ AI å§‹ç»ˆç†è§£å‡½æ•°çš„å…ƒå±æ€§ã€‚
2.  **è‡ªåŠ¨ä½œç”¨åŸŸè¿½è¸ª (Context-Aware Scope)**:
    æ¯ä¸€ä¸ªè¢«æ£€ç´¢åˆ°çš„å‡½æ•°ç‰‡æ®µï¼Œéƒ½é€šè¿‡ `parent_name` å…ƒæ•°æ®è‡ªåŠ¨å…³è”å…¶æ‰€å±çš„ç±»ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¼ ç»Ÿçš„åˆ‡åˆ†æ–¹æ¡ˆä¼šäº§ç”Ÿå¤§é‡â€œå­¤å„¿ä»£ç å—â€ï¼Œå¯¼è‡´ AI æ— æ³•ç¡®å®šè¯¥æ–¹æ³•æ˜¯å±äºå“ªä¸ªç±»æˆ–æ¨¡å—ã€‚
3.  **è¯­ä¹‰å•å…ƒæå– (Atomic Semantics)**:
    æˆ‘ä»¬ä¸é€šè¿‡å­—ç¬¦é•¿åº¦æ¥â€œèµŒâ€ä»£ç å®Œæ•´æ€§ã€‚é€šè¿‡ AST æå–çš„æ¯ä¸€ä¸ª Chunk éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯è§£æçš„è¯­æ³•å•å…ƒã€‚è¿™ä¸ä»…æ¶ˆé™¤äº†è¯­æ³•é”™è¯¯ï¼Œæ›´æå¤§æå‡äº†ä»£ç  Embedding çš„è´¨é‡ã€‚

## æ ¸å¿ƒæ¶æ„
```mermaid
graph TD
    A["æºä»£ç æ–‡ä»¶ (.py)"] --> B("AST è§£æå™¨ / Parser")
    B --> C{"è¯­ä¹‰åˆ‡åˆ†ç­–ç•¥"}
    C -->|FunctionDef| D["ä»£ç å— / Chunk"]
    C -->|ClassDef| D["ä»£ç å— / Chunk"]
    D --> E["å‘é‡æ•°æ®åº“ / ChromaDB"]
    D --> F["å¢å¼ºå…ƒæ•°æ®: ä¾èµ–å…³ç³»/çˆ¶èŠ‚ç‚¹"]
```

## å®‰è£…æŒ‡å—
```bash
git clone https://github.com/NRgamerwood/python-ast-rag.git
cd python-ast-rag
pip install -r requirements.txt
```

## å¿«é€Ÿå¼€å§‹
```python
from src.parser import ASTParser

source_code = """
class MyClass:
    def hello(self):
        print("Hello World")
"""

parser = ASTParser()
chunks = parser.parse_source(source_code, "example.py")

for chunk in chunks:
    print(f"Name: {chunk.metadata.name}")
    print(f"Type: {chunk.metadata.node_type}")
    print(f"Parent: {chunk.metadata.parent_name}")
    print(f"Content:\n{chunk.content}")
```

## é¡¹ç›®ç»“æ„
```text
python-ast-rag/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ parser.py       # AST è§£ææ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ vector_store.py # å‘é‡æ•°æ®åº“äº¤äº’
â”‚   â””â”€â”€ utils.py        # è¾…åŠ©å·¥å…·
â”œâ”€â”€ tests/              # å•å…ƒæµ‹è¯•
â”œâ”€â”€ benchmarks/         # åŸºå‡†æµ‹è¯•å¯¹æ¯” (Baseline å¯¹æ¯”ä¸ç»Ÿè®¡)
â”‚   â”œâ”€â”€ scripts/        # ç»Ÿè®¡ä¸å¯¹æ¯”è„šæœ¬
â”‚   â”œâ”€â”€ results/        # å¯è§†åŒ–å›¾è¡¨ä¸æ•°æ®æŠ¥å‘Š
â”‚   â””â”€â”€ requirements_bench.txt
â”œâ”€â”€ examples/           # ç¤ºä¾‹ä»£ç åº“
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

## è´¡çŒ®æŒ‡å—
è¯·éµå¾ª PEP 8 è§„èŒƒï¼Œå¹¶ç¡®ä¿æ‰€æœ‰æ–°åŠŸèƒ½éƒ½æœ‰å¯¹åº”çš„å•å…ƒæµ‹è¯•ã€‚
Git æäº¤è¯·ä½¿ç”¨ Conventional Commits è§„èŒƒã€‚

æœ¬é¡¹ç›®è‡ªåŠ¨åŒ–å®éªŒå®¤å·²æˆåŠŸå¤„ç†çš„ä»£ç åº“åˆ—è¡¨ï¼š
<!-- CONQUERED_LIST -->
- ğŸ† `Sibo-Zhao/OpenPraxis`
- ğŸ† `WingchunSiu/Monolith`
- ğŸ† `whyzhow/Kaggle-NeurIPS---Open-Polymer-Prediction-2025-Silver-Algorithm-Overview`
- ğŸ† `Intelligent-Internet/CommonGround`
- ğŸ† `slhleosun/EvoClaw`